<div class="d-grid gap-2">
    @if (!showForm)
    {
        <button class="btn btn-primary" type="button" @onclick="HandleOnClickApplyDiscount">Apply Discount</button>
    }
    else
    {
        <EditForm Model="@discountDto" OnValidSubmit="@HandleValidSubmit">
            <DataAnnotationsValidator />
            <ValidationSummary />

            <div class="mb-3">
                <label for="DiscountAmount" class="form-label">Discount Amount</label>
                <InputNumber id="DiscountAmount" @bind-Value="discountDto!.DiscountAmount" class="form-control" />
            </div>

            <button type="button" @onclick="() => showForm = false" class="btn btn-secondary">Cancel</button>
            <button type="submit" class="btn btn-success">Apply Discount</button>
        </EditForm>
    }
</div>

@code {
    [Parameter] public decimal CurrentDiscountAmount { get; set; }
    [Parameter] public EventCallback<decimal> OnApplyDiscount { get; set; }

    bool showForm = false;
    DiscountDto? discountDto;

    private void HandleOnClickApplyDiscount()
    {
        discountDto = new() { DiscountAmount = CurrentDiscountAmount };
        showForm = true;
    }

    private async Task HandleValidSubmit()
    {
        await OnApplyDiscount.InvokeAsync(discountDto!.DiscountAmount);
        showForm = false;
    }
}
