@*=====================================================================================================================================
    ===Part of this code was applied InvokeAsync of a view component and shared details with the other razor page.=========================
    ==For more details, try this linkhttps://visualstudiomagazine.com/articles/2018/02/01/invoking-view-components.aspx.===================
    ======================================================================================================================================*@

<div class="d-grid gap-2">
    <MudButton @onclick="CheckoutModal" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.ArrowUpward" Color="Color.Primary" Size="Size.Medium">@ButtonText</MudButton>
</div>

@*Checkout moodal========================================*@

<MudDialog @bind-IsVisible="visible" Options="dialogOptions">
    <TitleContent>
        <MudText Typo="Typo.h6">
            @*<MudIcon Icon="@Icons.Material.Filled.Add" Class="mr-3" /> @ShowDialogue*@
            title
        </MudText>
    </TitleContent>
    <DialogContent>
        <div class="row">
            <div class="col-lg-4 col-sm-12 col-12">
                <div class="form-group">
                    <label>Batch No</label>
                    <br/>
                </div>
            </div>
            <div class="col-lg-4 col-sm-12 col-12">
                <div class="form-group">
                    <label>Rate</label>
                </div>
            </div>
            <div class="col-lg-4 col-sm-12 col-12">
                <div class="form-group">
                    <label>Discount Amount</label>
                </div>
            </div>
            <div class="col-lg-4 col-sm-12 col-12">
                <div class="form-group">
                    <label>Tax</label>
                </div>
            </div>

            <div class="col-lg-12">
                <button type="button" @onclick="@CheckoutModal" class="btn btn-submit me-2">Save</button>
                <a @onclick="@Close" class="btn btn-cancel">Cancel</a>
            </div>
        </div>
    </DialogContent>
</MudDialog>



@code {
    [CascadingParameter] public IModalService Modal { get; set; } = default!;
    [Parameter] public string ButtonText { get; set; } = default!;
    [Parameter] public decimal AmountDue { get; set; }
    [Parameter] public EventCallback<AppendPaymentDto> OnAddPayment { get; set; }
    private MudBlazor.DialogOptions dialogOptions = new() { FullWidth = true };

    private bool visible = false;

    public async Task ShowModal()
    {
        ModalParameters modalParameters = new();
        modalParameters.Add(nameof(ExecutePayment.AmountDue), AmountDue);

        var addPaymentModal = Modal.Show<ExecutePayment>("Add Payment", modalParameters);
        var result = await addPaymentModal.Result;

        if (result.Confirmed)
        {
            var AppendPaymentDto = (AppendPaymentDto)result.Data!;
            await OnAddPayment.InvokeAsync(AppendPaymentDto);
        }
    }


    private void Close()
    {
        visible = false;
    }

    private void CheckoutModal()
    {
        visible = true;
    }
}